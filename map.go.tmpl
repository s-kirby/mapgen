package {{ .Package }}

/*
    GENERATED FILE, DO NOT EDIT

    This file was generated by https://github.com/ammario/mapgen
*/

// {{.MapName}} is a generated thread safe map
// with key {{.KeyType}} and value {{.ValType}}
type {{.MapName}} struct {
    mu sync.Mutex
    m map[{{.KeyType}}]{{.ValType}}
}  

// {{if .Exported}}New{{ else }}new{{end}}{{title .MapName}} returns an instantiated thread safe map
// with key {{.KeyType}} and value {{.ValType}}
func {{if .Exported}}New{{ else }}new{{end}}{{ title .MapName }}() *{{.MapName}} {
    return &{{.MapName}}{
        m: make(map[{{.KeyType}}]{{.ValType}}),
    }
}

// Lock locks the map and returns it.
func (m *{{.MapName}}) Lock() map[{{.KeyType}}]{{.ValType}} {
    m.mu.Lock()
    return m.m
}

// Unlock unlocks the map
func (m *{{.MapName}}) Unlock() {
    m.mu.Unlock()
}

// Set sets a key on the map
func (m *{{.MapName}}) Set(key {{.KeyType}}, val {{.ValType}}) {
    m.mu.Lock()
    m.m[key] = val
    m.mu.Unlock()
}

// Delete removes a key from the map
func (m *{{.MapName}}) Delete(key {{.KeyType}}) {
    m.mu.Lock()
    delete(m.m, key)
    m.mu.Unlock()
}

// Get retrieves a key from the map
func (m *{{.MapName}}) Get(key {{.KeyType}}) ({{.ValType}}) {
    m.mu.Lock()
    v := m.m[key]
    m.mu.Unlock()
    return v
}

// Len returns the length of the map
func (m *{{.MapName}}) Len() int {
    m.mu.Lock()
    n := len(m.m)
    m.mu.Unlock()
    return n
}

// GetEx retrieves a key from the map
// and whether it exists
func (m *{{.MapName}}) GetEx(key {{.KeyType}}) ({{.ValType}}, bool) {
    m.mu.Lock()
    v, exists := m.m[key]
    m.mu.Unlock()
    return v, exists
}

// Exists returns if a key exists
func (m *{{.MapName}}) Exists(key {{.KeyType}}) bool {
    m.mu.Lock()
    _, exists := m.m[key]
    m.mu.Unlock()
    return exists
}